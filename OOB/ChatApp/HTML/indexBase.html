<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Chatter</title>
		<link href="HTML/style.css" rel="stylesheet" />
	</head>
	<header>

	</header>

	<body>

	<div class="col-1-hidden"></div>
	<div class="box col-10">	
		<div id="messageWindow" class="chatLog col-10 backgroundColour scrollbar"> 
{{messages}}
		</div>

		<div id="Users" class="userList col-2 backgroundColour scrollbar">  <p>User(s) Online</p>
		<p class="username">
			
{{users}}
			
		</p>

		</div>

		<!--<div class="boxForMessage col-10 backgroundColour scrollbar">-->

			<div class="messageBox col-10 backgroundColour">
				<form action="/" method="post">
					<label for="Chat">Chat</label>
					<textarea id="Chat" name="chatmessage" row="1" style="width:100%">
					</textarea>
					</br>
					<input type="submit" value="Submit">
				</form>
				<button id="box" onclick="UserBox()">Show Users</button>
			</div>
		<!--</div>-->
	</div>
	<script>

        var interval = setInterval(function () {

            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "/users", false);
            xhttp.send();
            document.getElementById("Users").innerHTML = xhttp.responseText;
		}, 1000);

		var currentMessageHtml = document.getElementById("messageWindow").innerHTML;
        var interval = setInterval(function () {

            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", "/messages", false);
			xhttp.send();
            if (xhttp.responseText != currentMessageHtml) {
                document.getElementById("messageWindow").innerHTML = xhttp.responseText;
                var objDiv = document.getElementById("messageWindow");
				objDiv.scrollTop = objDiv.scrollHeight;
                currentMessageHtml = xhttp.responseText;
            }
        }, 1000);

	function UserBox()
	{
		var x = document.getElementById("Users");
		
		if(x.classList.contains("userList")){
			x.classList.replace("userList", "test");
		}else{
			x.classList.replace("test","userList");
		}
		var text = document.getElementById("box").firstChild;
		text.data = text.data == "Show Users" ? "Hide Users" : "Show Users";
	}

	
	</script>

	</body>




</html>